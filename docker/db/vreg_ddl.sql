-- MySQL Script generated by MySQL Workbench
-- Sun Jan 10 22:57:06 2021
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema vreg
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema vreg
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `vreg` DEFAULT CHARACTER SET utf8 ;
USE `vreg` ;

-- -----------------------------------------------------
-- Table `vreg`.`SPZ`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`SPZ` (
  `IDSPZ` INT NOT NULL AUTO_INCREMENT,
  `SPZ` VARCHAR(20) NOT NULL,
  PRIMARY KEY (`IDSPZ`),
  UNIQUE INDEX `SPZ_UNIQUE` (`SPZ` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vreg`.`VIN`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`VIN` (
  `IDVIN` INT NOT NULL AUTO_INCREMENT,
  `VIN` VARCHAR(40) NOT NULL,
  PRIMARY KEY (`IDVIN`),
  UNIQUE INDEX `VIN_UNIQUE` (`VIN` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vreg`.`DOCUMENT`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`DOCUMENT` (
  `IDDOCUMENT` INT NOT NULL AUTO_INCREMENT,
  `DOCUMENTNUMBER` VARCHAR(45) NOT NULL,
  `TODATE` DATETIME NULL,
  PRIMARY KEY (`IDDOCUMENT`),
  UNIQUE INDEX `DOCUMENTNUMBER_UNIQUE` (`DOCUMENTNUMBER` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vreg`.`PERSON`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`PERSON` (
  `IDPERSON` INT NOT NULL AUTO_INCREMENT,
  `FIRSTNAME` VARCHAR(45) NOT NULL,
  `LASTNAME` VARCHAR(45) NOT NULL,
  `BORNNUM` VARCHAR(25) NOT NULL,
  PRIMARY KEY (`IDPERSON`),
  UNIQUE INDEX `BORNNUM_UNIQUE` (`BORNNUM` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vreg`.`VEHICLE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`VEHICLE` (
  `IDVEHICLE` INT NOT NULL AUTO_INCREMENT,
  `IDSPZ` INT NULL,
  `IDVIN` INT NOT NULL,
  `IDSTECHNICALCERT` INT NULL,
  `IDBTECHNICALCERT` INT NULL,
  `IDOWNER` INT NOT NULL,
  `ACTIVE` TINYINT NOT NULL DEFAULT 1,
  PRIMARY KEY (`IDVEHICLE`),
  INDEX `fk_VEHICLE_SPZ_idx` (`IDSPZ` ASC) VISIBLE,
  INDEX `fk_VEHICLE_VIN1_idx` (`IDVIN` ASC) VISIBLE,
  INDEX `fk_VEHICLE_DOCUMENT1_idx` (`IDSTECHNICALCERT` ASC) VISIBLE,
  INDEX `fk_VEHICLE_DOCUMENT2_idx` (`IDBTECHNICALCERT` ASC) VISIBLE,
  INDEX `fk_VEHICLE_USER1_idx` (`IDOWNER` ASC) VISIBLE,
  CONSTRAINT `fk_VEHICLE_SPZ`
    FOREIGN KEY (`IDSPZ`)
    REFERENCES `vreg`.`SPZ` (`IDSPZ`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_VEHICLE_VIN1`
    FOREIGN KEY (`IDVIN`)
    REFERENCES `vreg`.`VIN` (`IDVIN`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_VEHICLE_DOCUMENT1`
    FOREIGN KEY (`IDSTECHNICALCERT`)
    REFERENCES `vreg`.`DOCUMENT` (`IDDOCUMENT`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_VEHICLE_DOCUMENT2`
    FOREIGN KEY (`IDBTECHNICALCERT`)
    REFERENCES `vreg`.`DOCUMENT` (`IDDOCUMENT`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_VEHICLE_USER1`
    FOREIGN KEY (`IDOWNER`)
    REFERENCES `vreg`.`PERSON` (`IDPERSON`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vreg`.`USER`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`USER` (
  `IDUSER` INT NOT NULL,
  `ROLE` ENUM('ADMIN', 'INSURER', 'CLERK') NOT NULL,
  `PASSWORD` TEXT(512) NOT NULL,
  `ENABLE` TINYINT NOT NULL,
  `LOGIN` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`IDUSER`),
  INDEX `fk_USER_HUMAN1_idx` (`IDUSER` ASC) VISIBLE,
  UNIQUE INDEX `LOGIN_UNIQUE` (`LOGIN` ASC) VISIBLE,
  CONSTRAINT `fk_USER_HUMAN1`
    FOREIGN KEY (`IDUSER`)
    REFERENCES `vreg`.`PERSON` (`IDPERSON`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vreg`.`INSURANCE_COMPANY`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`INSURANCE_COMPANY` (
  `IDINSURANCECOMPANY` INT NOT NULL AUTO_INCREMENT,
  `COMPANYNAME` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`IDINSURANCECOMPANY`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vreg`.`INSURANCE_EMPLOYEE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`INSURANCE_EMPLOYEE` (
  `IDUSER` INT NOT NULL,
  `IDINSURANCECOMPANY` INT NOT NULL,
  PRIMARY KEY (`IDUSER`, `IDINSURANCECOMPANY`),
  INDEX `fk_INSURENCEEMPLOYEES_INSURENCE1_idx` (`IDINSURANCECOMPANY` ASC) VISIBLE,
  CONSTRAINT `fk_INSURENCEEMPLOYEES_USER1`
    FOREIGN KEY (`IDUSER`)
    REFERENCES `vreg`.`USER` (`IDUSER`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_INSURENCEEMPLOYEES_INSURENCE1`
    FOREIGN KEY (`IDINSURANCECOMPANY`)
    REFERENCES `vreg`.`INSURANCE_COMPANY` (`IDINSURANCECOMPANY`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vreg`.`INSURANCE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vreg`.`INSURANCE` (
  `IDINSURANCE` INT NOT NULL AUTO_INCREMENT,
  `FROMDATE` DATETIME NOT NULL,
  `TODATE` DATETIME NOT NULL,
  `IDINSURANCECOMPANY` INT NOT NULL,
  `IDVEHICLE` INT NOT NULL,
  `IDINSURANCER` INT NOT NULL,
  `IDPERSON` INT NOT NULL,
  PRIMARY KEY (`IDINSURANCE`),
  INDEX `fk_INSURANCE_INSURANCE_COMPANY1_idx` (`IDINSURANCECOMPANY` ASC) VISIBLE,
  INDEX `fk_INSURANCE_VEHICLE1_idx` (`IDVEHICLE` ASC) VISIBLE,
  INDEX `fk_INSURANCE_INSURANCEEMPLOYEES1_idx` (`IDINSURANCER` ASC) VISIBLE,
  INDEX `fk_INSURANCE_PERSON1_idx` (`IDPERSON` ASC) VISIBLE,
  CONSTRAINT `fk_INSURANCE_INSURANCE_COMPANY1`
    FOREIGN KEY (`IDINSURANCECOMPANY`)
    REFERENCES `vreg`.`INSURANCE_COMPANY` (`IDINSURANCECOMPANY`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_INSURANCE_VEHICLE1`
    FOREIGN KEY (`IDVEHICLE`)
    REFERENCES `vreg`.`VEHICLE` (`IDVEHICLE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_INSURANCE_INSURANCEEMPLOYEES1`
    FOREIGN KEY (`IDINSURANCER`)
    REFERENCES `vreg`.`INSURANCE_EMPLOYEE` (`IDUSER`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_INSURANCE_PERSON1`
    FOREIGN KEY (`IDPERSON`)
    REFERENCES `vreg`.`PERSON` (`IDPERSON`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
